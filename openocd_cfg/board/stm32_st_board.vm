## Apache Velocity template
## Please see http://velocity.apache.org/engine/2.0/translations/user-guide_fr.html
##
# This is an $boardName board with a single $mcu.getName() chip
#
# Generated by System Workbench for STM32
# Take care that such file, as generated, may be overridden without any early notice. Please have a look to debug launch configuration setup(s)

#if ($isShareableDevice)
source [find interface/stlink-tcp.cfg]
#elseif ($dbgDevice.name() == "STLink")
source [find interface/stlink.cfg]
#elseif ($dbgDevice.name() == "STLinkV2")
source [find interface/stlink-v2.cfg]
#elseif ($dbgDevice.name() == "STLinkV21")
source [find interface/stlink-v2-1.cfg]
#end

## Limit work area size to 32K
#if ($mcu.getWorkAreaSize() < (32 * 1024))
#set($Integer = 0)
set WORKAREASIZE 0x$Integer.toHexString($mcu.getWorkAreaSize())
#else
set WORKAREASIZE 0x8000
#end

#if ($dbgInterface.name() == "SWD")
transport select "hla_swd"
#elseif ($dbgInterface.name() == "JTAG")
transport select "hla_jtag"
#end

set CHIPNAME $mcu.getName()
set BOARDNAME $boardName

# CHIPNAMES state
#foreach ($entry in $chipnameActivatedMap.entrySet())
#if (${entry.value})
set ${entry.key} 1
#else
set ${entry.key} 0
#end
#end

# Enable debug when in low power modes
#if ($isLowPowerModeAllowed)
set ENABLE_LOW_POWER 1
#else
set ENABLE_LOW_POWER 0
#end

# Stop Watchdog counters when halt
#if ($isWatchdogStopWhenHaltedAllowed)
set STOP_WATCHDOG 1
#else
set STOP_WATCHDOG 0
#end

# STlink Debug clock frequency
#set ($CLOCKFREQ = ($dbgInterfaceFrequency.intValue()/1000))
set CLOCK_FREQ $CLOCKFREQ

#if ($resetMode.name() == "CONNECT_UNDER_RESET")
# use hardware reset, connect under reset
# connect_assert_srst needed if low power mode application running (WFI...)
reset_config srst_only srst_nogate connect_assert_srst
set CONNECT_UNDER_RESET 1
#elseif ($resetMode.name() == "HARD")
# use hardware reset
reset_config srst_only srst_nogate
set CONNECT_UNDER_RESET 0
#elseif ($resetMode.name() == "SOFT")
# use software system reset
reset_config none
set CONNECT_UNDER_RESET 0
#end

# BCTM CPU variables
#foreach ($entry in $bctmMap.entrySet())
set BCTM_${entry.key}_CAN_HALT 1
#foreach ($entry2 in $entry.value)
set BCTM_${entry2}_CAN_BE_HALTED 1
#end
#end



#set( $fileSuffix = "x" )
#set( $fileExtension = ".cfg" )
source [find target/$mcu.getTopFamily().getName().toLowerCase()$fileSuffix$fileExtension]
